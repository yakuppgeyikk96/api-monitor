<aside
  class="fixed left-0 top-0 h-screen bg-white border-r border-gray-200 flex flex-col transition-all duration-300 ease-in-out z-20"
  [style.width]="sidebarService.width()"
>
  <!-- Logo + Toggle -->
  <div class="h-16 flex items-center justify-between border-b border-gray-200 shrink-0 overflow-hidden"
    [class.px-5]="!sidebarService.collapsed()"
    [class.justify-center]="sidebarService.collapsed()"
  >
    @if (!sidebarService.collapsed()) {
      <span class="text-lg font-bold text-indigo-600 whitespace-nowrap">API Monitor</span>
    }
    <button
      (click)="sidebarService.toggle()"
      class="flex items-center justify-center size-9 rounded-lg text-gray-500 hover:bg-gray-100 hover:text-gray-700 transition-all duration-300 ease-in-out"
    >
      @if (sidebarService.collapsed()) {
        <app-panel-left-open-icon [size]="20" />
      } @else {
        <app-panel-left-close-icon [size]="20" />
      }
    </button>
  </div>

  <!-- Navigation -->
  <nav class="flex-1 py-4">
    @for (item of navItems; track item.path) {
      @if (item.children) {
        <!-- Parent item with children -->
        <a
          [routerLink]="item.path"
          routerLinkActive
          #parentRla="routerLinkActive"
          class="hidden"
        ></a>
        <button
          (click)="toggleExpand(item.path)"
          class="flex items-center w-full h-11 transition-all duration-300 ease-in-out"
          [class]="parentRla.isActive
            ? 'bg-indigo-50 text-indigo-600'
            : 'text-gray-600 hover:bg-gray-50 hover:text-gray-900'"
          [class.justify-center]="sidebarService.collapsed()"
          [class.px-5]="!sidebarService.collapsed()"
          [class.gap-3]="!sidebarService.collapsed()"
        >
          <ng-container [ngComponentOutlet]="item.icon" [ngComponentOutletInputs]="{ size: 20 }" />
          @if (!sidebarService.collapsed()) {
            <span class="text-sm font-medium whitespace-nowrap">{{ item.label }}</span>
            <app-chevron-down-icon
              [size]="16"
              class="ml-auto transition-transform duration-200"
              [class.-rotate-90]="!isExpanded(item.path)"
            />
          }
        </button>

        <!-- Children -->
        @if (!sidebarService.collapsed() && isExpanded(item.path)) {
          @for (child of item.children; track child.path) {
            <a
              [routerLink]="child.path"
              routerLinkActive
              #childRla="routerLinkActive"
              class="flex items-center h-10 pl-12 pr-5 text-sm transition-all duration-200"
              [class]="childRla.isActive
                ? 'text-indigo-600 bg-indigo-50/50'
                : 'text-gray-500 hover:text-gray-900 hover:bg-gray-50'"
            >
              {{ child.label }}
            </a>
          }
        }
      } @else {
        <!-- Simple item without children -->
        <a
          [routerLink]="item.path"
          routerLinkActive
          #rla="routerLinkActive"
          class="flex items-center h-11 transition-all duration-300 ease-in-out"
          [class]="rla.isActive
            ? 'bg-indigo-50 text-indigo-600'
            : 'text-gray-600 hover:bg-gray-50 hover:text-gray-900'"
          [class.justify-center]="sidebarService.collapsed()"
          [class.px-5]="!sidebarService.collapsed()"
          [class.gap-3]="!sidebarService.collapsed()"
        >
          <ng-container [ngComponentOutlet]="item.icon" [ngComponentOutletInputs]="{ size: 20 }" />
          @if (!sidebarService.collapsed()) {
            <span class="text-sm font-medium whitespace-nowrap">{{ item.label }}</span>
          }
        </a>
      }
    }
  </nav>
</aside>
